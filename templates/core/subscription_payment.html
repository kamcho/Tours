{% extends 'users/base.html' %}
{% load static %}

{% block title %}Complete Payment - TravelsKe{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50 py-12">
    <div class="container mx-auto px-4">
        <div class="max-w-2xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Complete Your Subscription</h1>
                <p class="text-gray-600">Choose your payment method to activate your subscription</p>
            </div>

            <!-- Subscription Details -->
            <div class="bg-white rounded-2xl shadow-lg p-8 mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Subscription Details</h2>
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Plan:</span>
                        <span class="font-medium">{{ subscription.get_subscription_type_display }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Amount:</span>
                        <span class="font-medium text-green-600">KES {{ subscription.amount }}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600">Duration:</span>
                        <span class="font-medium">{{ subscription.end_date|date:"M d, Y" }}</span>
                    </div>
                </div>
            </div>

            <!-- Payment Form -->
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <form method="POST" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Payment Method Selection -->
                    <div>
                        <label class="block text-lg font-semibold text-gray-800 mb-4">
                            Select Payment Method
                        </label>
                        <div class="space-y-3">
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-green-500 transition-colors">
                                <input type="radio" name="payment_method" value="mpesa" class="mr-3 text-green-600" checked required>
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3">
                                        <span class="text-green-600 font-bold text-sm">M</span>
                                    </div>
                                    <div>
                                        <div class="font-medium text-gray-800">M-Pesa</div>
                                        <div class="text-sm text-gray-600">Pay with M-Pesa mobile money</div>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Phone Number -->
                    <div>
                        <label for="phone_number" class="block text-sm font-semibold text-gray-700 mb-2">
                            M-Pesa Phone Number *
                        </label>
                        <input type="tel" name="phone_number" id="phone_number" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition duration-200"
                               placeholder="+254 XXX XXX XXX" required>
                        <p class="text-sm text-gray-500 mt-1">Enter the phone number registered with M-Pesa</p>
                    </div>

                    <!-- Payment Summary -->
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h3 class="font-semibold text-gray-800 mb-3">Payment Summary</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Subscription:</span>
                                <span>{{ subscription.get_subscription_type_display }}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Amount:</span>
                                <span class="font-semibold text-green-600">KES {{ subscription.amount }}</span>
                            </div>
                            <div class="border-t pt-2">
                                <div class="flex justify-between">
                                    <span class="font-semibold text-gray-800">Total:</span>
                                    <span class="font-bold text-xl text-green-600">KES {{ subscription.amount }}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="pt-4">
                        <button type="submit" 
                                class="w-full bg-gradient-to-r from-green-600 to-blue-600 text-white py-4 rounded-xl font-semibold text-lg hover:from-green-700 hover:to-blue-700 transition-all duration-300 shadow-lg hover:shadow-xl">
                            Pay with M-Pesa
                        </button>
                    </div>
                </form>
            </div>

            <!-- Important Notes -->
            <div class="bg-blue-50 rounded-2xl p-6 mt-8">
                <h3 class="font-semibold text-blue-800 mb-3">Important Notes:</h3>
                <ul class="text-blue-700 space-y-2 text-sm">
                    <li>• Ensure you have sufficient M-Pesa balance</li>
                    <li>• You will receive an STK push notification on your phone</li>
                    <li>• Enter your M-Pesa PIN when prompted</li>
                    <li>• Your subscription will be activated immediately after successful payment</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %} 